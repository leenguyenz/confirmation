@using System.Globalization
@using GoQuoEngine.Data.Domain
@using GoQuoEngine.Flights
@using GoQuoEngine.Hotels
@using MvcCornerstone.Extensions
@using System.Linq
@using GoQuoEngine.Core.Extensions
@using Newtonsoft.Json
@using GoQuoEngine.Transfers


@{
    Booking booking = Model.Booking;
    var taxInvoice = Model.TaxInvoice;

    var flightPriceAndTax = booking.OutboundFlight.Price + booking.OutboundFlight.MarkupPrice + booking.OutboundFlight.TaxPrice;
   var taxFlightHotel = flightPriceAndTax + Convert.ToDecimal(taxInvoice.Hotel);
   
    List<BookingPassengerInfo>
    passengerInfos = booking.Passengers.ToList();
    BookingCustomerInfo customerInfo = booking.CustomerInfo;

    List<BookingHotelInfo> hotels = booking.Hotels.ToList();
    BookingHotelInfo hotel = booking.Hotels.First();

    var providerNames = hotel.HotelRooms.Select(h => h.ProviderName).Distinct();
    string supplierName = String.Join(",", providerNames);
    string hotelConfirmNumber = hotel.HotelRooms.First().ConfirmationNumber;
    //HotelAvailable hotelAvailable = hotel1.GetHotelAvailable();
    //AvailableRoom availableRoom = hotelAvailable.AvailableRooms.First();
    //AvailableRoomType availableRoomType = availableRoom.AvailableRoomTypes.First();

    List<BookingTourInfo> tours = booking.Tours.ToList();
    //FlightResponse outboundFlight = Model.OutboundFlight;
    //FlightResponse inboundFlight = Model.InboundFlight;

    BookingTransferInfo arrivalTransfer = booking.ArrivalTransfer;
    //   TransferResponse arrivalTransferResponse = Model.ArrivalTransfer;
    BookingTransferInfo departureTransfer = booking.DepartureTransfer;
    //  TransferResponse departureTransferResponse = Model.DepartureTransfer;

    var paymentCurrency = Model.Booking.Currency;
    var paymentAmount = decimal.Zero;
    if (!string.IsNullOrEmpty(Model.Booking.PaymentRequest))
    {
        var paymentRequest = JsonConvert.DeserializeObject<Dictionary<string, string>>(Model.Booking.PaymentRequest);
        if (paymentRequest.ContainsKey("PurAmount"))
        {
            var amount = paymentRequest["PurAmount"];
            if (!string.IsNullOrEmpty(amount))
            {
                decimal.TryParse(amount, out paymentAmount);
            }
        }
        if (paymentRequest.ContainsKey("Currency"))
        {
            paymentCurrency = paymentRequest["Currency"];
        }
    }

    var baggagePrice = decimal.Zero;
    var mealPrice = decimal.Zero;
    var seatPrice = decimal.Zero;

    if (booking.Seats != null && booking.Seats.Any())
    {
        seatPrice = booking.Seats.Sum(x => x.TotalPrice);
    }

    if (booking.Addons != null && booking.Addons.Any())
    {
        var baggages = booking.Addons.Where(x => x.AddonType == AddonType.Baggage).ToList();
        if (baggages.Any())
        {
            baggagePrice = baggages.Sum(x => x.TotalPrice);
        }

        var meals = booking.Addons.Where(x => x.AddonType == AddonType.Meal).ToList();
        if (meals.Any())
        {
            mealPrice = meals.Sum(x => x.TotalPrice);
        }
    }

    var packagePriceIncludeTax = Model.PackagePrice + booking.TaxesAndFees;
    var currencyRate = booking.OutboundFlight.CurrencyRate;
    var flightTaxAndFee = 120 * booking.OutboundFlight.CurrencyRate;
    var totalPrice = Model.TotalPrice - Model.Summary.TourPrice - Model.Summary.TransferPrice;
    var totalPricePerPerson = totalPrice / passengerInfos.Count();
    var totayNights = (Model.Booking.CheckOut - Model.Booking.CheckIn).TotalDays;

    var cancellationsArrival = new List<CancellationPolicy>();
    var cancellationsDeparture = new List<CancellationPolicy>();

    BookingTransferInfo arrTransfer = Model.Booking.ArrivalTransfer;
	BookingTransferInfo depTransfer = Model.Booking.ArrivalTransfer;





    //if (arrivalTransferResponse != null)
    //{
    //    cancellationsArrival = arrivalTransferResponse.GetCancellationPolicy();
    //}
    //if (departureTransferResponse != null)
    //{
    //    cancellationsDeparture = departureTransferResponse.GetCancellationPolicy();
    //}

            decimal tourPrice = 0;
    if (booking.Tours != null && booking.Tours.Any())
    {
        tourPrice = booking.Tours.Sum(x => x.TotalPrice);
    }

    decimal transferPrice = 0;

    if (Model.Booking.ArrivalTransfer != null || Model.Booking.DepartureTransfer != null)
    {
        if (booking.ArrivalTransfer != null)
        {
            transferPrice += booking.ArrivalTransfer.TotalPrice;
        }
        if (Model.Booking.DepartureTransfer != null)
        {
            transferPrice += booking.DepartureTransfer.TotalPrice;
        }
    }

    var outboundFlightLegs = Model.OutboundFlight.GetLegs();
    var inboundFlightLegs = Model.InboundFlight.GetLegs();
	
	List<GoQuoEngine.GoQuoTransferService.ClassApi.VoucherInfo> arrTransferVoucherInfos = new List<GoQuoEngine.GoQuoTransferService.ClassApi.VoucherInfo>();
	List<GoQuoEngine.GoQuoTransferService.ClassApi.VoucherInfo> departureTransferVoucherInfos = new List<GoQuoEngine.GoQuoTransferService.ClassApi.VoucherInfo>();
	if(arrTransfer != null && !string.IsNullOrEmpty(arrTransfer.VoucherInfo))
	{
	  arrTransferVoucherInfos = arrTransfer.VoucherInfo.JsonDeserialize<List<GoQuoEngine.GoQuoTransferService.ClassApi.VoucherInfo>>();
	  arrTransferVoucherInfos = arrTransferVoucherInfos.Where(x => x.Category.Trim().Equals("Instructions") || x.Category.Trim().Equals("Contact details")).ToList();
	  if (arrTransferVoucherInfos.Any())
		{
			foreach (var item in arrTransferVoucherInfos)
			{
				item.Category = item.Category.Trim();
				item.Name = item.Name.Trim().ToLower();
				item.Content = item.Content.Trim().Replace("\\n", "").Replace("\\r", "");
			}
		}
	}
	
	if(departureTransfer != null && !string.IsNullOrEmpty(departureTransfer.VoucherInfo))
	{
	  
	   departureTransferVoucherInfos = departureTransfer.VoucherInfo.JsonDeserialize<List<GoQuoEngine.GoQuoTransferService.ClassApi.VoucherInfo>>();
	   departureTransferVoucherInfos = departureTransferVoucherInfos.Where(x => x.Category.Trim().Equals("Instructions") || x.Category.Trim().Equals("Contact details")).ToList();
	   if (departureTransferVoucherInfos.Any())
		{
			foreach (var item in departureTransferVoucherInfos)
			{
				item.Category = item.Category.Trim();
				item.Name = item.Name.Trim().ToLower();
				item.Content = item.Content.Trim().Replace("\\n", "").Replace("\\r", "");
			}
		}
	}

}
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Air Arabia</title>
    <link rel="icon" href="favicon.ico" />
</head>
<body style="margin: 0; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 25px; background-color: #fff;" bgcolor="#fff">
    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0 0 15px 0px; border-bottom: 1px solid #CCC; background-color: ">
        <tbody>
            <tr>
                <td align="center"><a href="#" target="_blank" style="border: none;"><img style="border: none;" src="https://gqcdn.s3.amazonaws.com/GoQuoEngine/G9/logo.png" /></a></td>
            </tr>
        </tbody>
    </table>

    <!--Table END-->

    <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px; ; border-collapse: collapse;">
        <tbody>
            <tr>
                <td colspan="2" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Holiday Voucher</td>
            </tr>
            <tr>
                <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                    <strong>Voucher Number :</strong> @Model.Booking.BookingConfirmRef
                </td>
                <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                    <strong>Booking Date :</strong> @string.Format("{0:dd/MM/yyyy}", Model.Booking.BookingDate)
                </td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 5px 0px 0;">
        <tbody>
            <tr>
                <td style="background: #F0F0F0; padding: 15px; width: 65%">
                    <table width="" cellspacing="0" cellpadding="0" style="padding: 0px; line-height: 32px; border-collapse: collapse; border-color: #CCC">
                        <tbody>
                            <tr>
                                <td style="color: #ed0000; font-size: 24px;">
                                    Holiday Package to @outboundFlightLegs[outboundFlightLegs.Count - 1].ArrivalCountryName
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 50%; color: #333; padding: 5px 0px 0px; border-color: #CCC; font-size: 14px;">
                                    Return Flight to <strong>@outboundFlightLegs[outboundFlightLegs.Count - 1].ArrivalCityName</strong>
                                </td>
                            </tr>
                            <tr>
                                <td style="color: #333; padding: 0px; border-color: #CCC; font-size: 14px;">
                                    @totayNights Nights in <strong>@hotel.Name</strong>
                                </td>
                            </tr>
                            <tr>
                                <td style="color: #333; padding: 0px; border-color: #CCC; font-size: 14px;">
                                    @if (Model.Booking.ArrivalTransfer != null || Model.Booking.DepartureTransfer != null)
                                    {
                                        <span>Transfers: Included</span>
                                    }
                                </td>
                            </tr>
                            <tr>
                                <td style="color: #333; padding: 0px; border-color: #CCC; font-size: 14px;">
                                    @if (Model.Booking.Tours != null && Model.Booking.Tours.Count > 0)
                                    {
                                        <span>Tour: Included</span>
                                    }
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td style=""></td>
            </tr>
        </tbody>
    </table>

    @if ((booking.ShowPriceInVoucher && booking.BookingType == "B2B") || booking.BookingType != "B2B")
    {
        <table class="table table-condensed" bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px; ; border-collapse: collapse;">
            <tbody>
                <tr>
                    <td colspan="4" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Price Summary </td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Flight + Hotel
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @Model.Currency
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; border-right: 0px; text-align: right;">
                        @(taxFlightHotel.ToString("N" + Model.CurrencyDecimals, CultureInfo.InvariantCulture))
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Activities
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.Activities) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.Activities) == decimal.Zero ? "N/A" : System.Convert.ToDecimal(taxInvoice.Activities))
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Transfer
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.Transfer) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.Transfer) == decimal.Zero ? "N/A" : taxInvoice.Transfer)
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Seats
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.Seats) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.Seats) == decimal.Zero ? "N/A" : taxInvoice.Seats)
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Meals
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.Meals) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.Meals) == decimal.Zero ? "N/A" : taxInvoice.Meals)
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Baggage
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.Baggage) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.Baggage) == decimal.Zero ? "N/A" : taxInvoice.Baggage)
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                @if (Model.InsurancePrice > 0)
                {
                    <tr>
                        <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                            Insurance
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                            @(System.Convert.ToDecimal(taxInvoice.Insurance) == decimal.Zero ? "" : Model.Currency)
                        </td>
                        <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                            @(System.Convert.ToDecimal(taxInvoice.Insurance) == decimal.Zero ? "N/A" : taxInvoice.Insurance)
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                    </tr>
                }
                else
                {
                    <tr>
                        <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                            Insurance
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px"></td>
                        <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                            N/A
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                    </tr>
                }
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Service Charge
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.ServiceCharge) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.ServiceCharge) == decimal.Zero ? "N/A" : taxInvoice.ServiceCharge)
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                        Taxes
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        @(System.Convert.ToDecimal(taxInvoice.GstAmount) == decimal.Zero ? "" : Model.Currency)
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                        @(System.Convert.ToDecimal(taxInvoice.GstAmount) == decimal.Zero ? "N/A" : taxInvoice.GstAmount)
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                @if (@booking.PromoPrice > 0)
                {
                    <tr>
                        <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                            Your Saving
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                            @Model.Currency
                        </td>
                        <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                            @booking.PromoPrice.ToString("N" + Model.CurrencyDecimals, CultureInfo.InvariantCulture)
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                    </tr>
                }
                else
                {
                    <tr>
                        <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 14px">
                            Your Saving
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px"></td>
                        <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 14px; text-align: right;">
                            N/A
                        </td>
                        <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                    </tr>
                }
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 17px">
                        <strong>Total Amount</strong>
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        <strong>@Model.Currency</strong>
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; text-align: right; font-size: 17px; text-align: right;">
                        <strong>@Model.TotalPrice.ToString("N" + Model.CurrencyDecimals, CultureInfo.InvariantCulture)</strong>
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
                <tr>
                    <td style="width: 75%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; font-size: 17px">
                        <strong>Payment Amount</strong>
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-right: 0px; border-left: 0px; text-align: right; font-size: 14px">
                        <strong>@((string.IsNullOrEmpty(paymentCurrency) || paymentAmount == decimal.Zero) ? Model.Currency : paymentCurrency)</strong>
                    </td>
                    <td style="width: 15%; color: #333; padding: 5px 10px; border: 1px solid #CCC; border-left: 0px; border-right: 0px; font-size: 17px; text-align: right;">
                        <strong>@(paymentAmount == decimal.Zero ? Model.TotalPrice.ToString("N" + Model.CurrencyDecimals, CultureInfo.InvariantCulture) : paymentAmount.ToString("N" + Model.CurrencyDecimals, CultureInfo.InvariantCulture))</strong>
                    </td>
                    <td style="width: 5%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px; border-left: 0px; text-align: right;"></td>
                </tr>
            </tbody>
        </table>
    }

    <!--Table END-->

    <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px; ; border-collapse: collapse;">
        <tbody>
            <tr>
                <td style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Passengers </td>
            </tr>
            @for (int i = 0; i < Model.Booking.Passengers.Count; i++)
            {
                <tr>
                    <td style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                        @(i + 1). @Model.Passengers[i].Title.ToUpper() @Model.Passengers[i].FirstName.ToUpper() @Model.Passengers[i].LastName.ToUpper()
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <!--Table END-->
    <div style='page-break-after:always'></div>
    <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px; border-collapse: collapse;">
        <tbody>
            <tr>
                <td colspan="5" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Flight Details</td>
            </tr>
            <tr>
                <td colspan="5" style="border: 1px solid #CCC; font-size: 14px; padding: 5px 10px"><strong>PNR Number :</strong> @Model.Booking.ReservationCode</td>
            </tr>
        </tbody>
    </table>

    <!--Departing-->
    @if (booking.OutboundFlight != null)
    {
        foreach (Leg leg in outboundFlightLegs)
        {
            <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px; border-collapse: collapse;">
                <tbody>
                    <tr>
                        <td colspan="5" style="background: #ffecee; width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                            <strong> Departing : <span style="float: right">@leg.DepartureAirportCode – @leg.ArrivalAirportCode </span></strong>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Flight Number :</strong> @Model.OutboundFlight.AirlineCode@leg.FlightNumber
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Departure :</strong> @leg.DepartureAirportName (@leg.DepartureAirportCode) at @leg.DepartureDate.ToString("dd MMM yyyy HH:mm")
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Arrival : </strong> @leg.ArrivalAirportName (@leg.ArrivalAirportCode) at @leg.ArrivalDate.ToString("dd MMM yyyy HH:mm")
                        </td>
                    </tr>
                </tbody>
            </table>

            <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px; border-collapse: collapse;">
                <tbody>
                    <tr>
                        <td colspan="5" style="width: 100%; background: #F0F0F0; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Extras </strong> </td>
                    </tr>
                    <tr>
                        <td style="width: 30%; text-align: left; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Passenger Name</td>
                        <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Baggage</td>
                        <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Seats</td>
                        <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Meals</td>
                        <td style="width: 10%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Insurance</td>
                    </tr>

                    @for (int i = 0; i < passengerInfos.Count; i++)
                    {
                        var pax = passengerInfos[i];
                        var meal = booking.Addons.FirstOrDefault(x => x.PaxNo == pax.Order && x.From == leg.DepartureAirportCode && x.AddonType == AddonType.Meal);
                        var seat = booking.Seats.FirstOrDefault(x => x.PaxNo == pax.Order && x.From == leg.DepartureAirportCode);
                        <tr>
                            <td style="width: 30%; text-align: left; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                                @(i + 1). @pax.Title @pax.FirstName @pax.LastName (@pax.PassengerType)
                            </td>
                            <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                                @{
                                    var departureBaggage = new BookingFlightAddon();
                                }
                                @if (booking.Addons != null && booking.Addons.Any())
                                {
                                    departureBaggage = booking.Addons.FirstOrDefault(x => x.AddonType == AddonType.Baggage && x.PaxNo == Model.Booking.Passengers[i].Order && x.From == booking.OutboundFlight.From);
                                }
                                <span style="text-transform: uppercase;">@((departureBaggage != null && !string.IsNullOrEmpty(departureBaggage.Code) && departureBaggage.Code != "No Bag") ? string.Format("{0}", departureBaggage.Code.Replace("PB", "")) : "0 kg")</span>
                            </td>
                            <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">

                                <span>
                                    @if (seat != null && !pax.PassengerType.Equals("Infant"))
                                    {
                                        <span>@seat.SeatName</span>
                                    }
                                    else
                                    {
                                        <span>Not included</span>
                                    }
                                </span>
                            </td>
                            <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">

                                <span>
                                    @if (meal != null)
                                    {
                                        <span>@meal.Name.ToLower(), </span>
                                    }
                                    else
                                    {
                                        <span>Not included</span>
                                    }
                                </span>
                            </td>
                            <td style="width: 10%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                                @if (Model.InsurancePrice > 0)
                                {
                                    <span>Yes</span>
                                }
                                else
                                {
                                    <span>No</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    }

    <!--Returning-->
    @if (booking.InboundFlight != null)
    {
        foreach (Leg leg in inboundFlightLegs)
        {
            <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px; border-collapse: collapse;">
                <tbody>
                    <tr>
                        <td colspan="5" style="background: #ffecee; width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                            <strong> Returning : <span style="float: right">@leg.DepartureAirportCode – @leg.ArrivalAirportCode</span></strong>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Flight Number :</strong> @Model.InboundFlight.AirlineCode@leg.FlightNumber
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Departure :</strong> @leg.DepartureAirportName (@leg.DepartureAirportCode) at @leg.DepartureDate.ToString("dd MMM yyyy HH:mm")
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" style="width: 100%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Arrival : </strong> @leg.ArrivalAirportName (@leg.ArrivalAirportCode) at @leg.ArrivalDate.ToString("dd MMM yyyy HH:mm")
                        </td>
                    </tr>
                </tbody>
            </table>
            <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px; border-collapse: collapse;">
                <tbody>
                    <tr>
                        <td colspan="5" style="width: 100%; background: #F0F0F0; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Extras </strong> </td>
                    </tr>
                    <tr>
                        <td style="width: 30%; text-align: left; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Passenger Name</td>
                        <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Baggage</td>
                        <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Seats</td>
                        <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Meals</td>
                        <td style="width: 10%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">Insurance</td>
                    </tr>
                    @for (int i = 0; i < passengerInfos.Count; i++)
                    {
                        var pax = passengerInfos[i];
                        var meal = booking.Addons.FirstOrDefault(x => x.PaxNo == pax.Order && x.From == leg.DepartureAirportCode && x.AddonType == AddonType.Meal);
                        var seat = booking.Seats.FirstOrDefault(x => x.PaxNo == pax.Order && x.From == leg.DepartureAirportCode);
                        <tr>
                            <td style="width: 30%; text-align: left; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                                @(i + 1). @pax.Title @pax.FirstName @pax.LastName (@pax.PassengerType)
                            </td>
                            <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                                @{
                                    var returnBaggage = new BookingFlightAddon();
                                }
                                @if (booking.Addons != null && booking.Addons.Any())
                                {
                                    returnBaggage = booking.Addons.FirstOrDefault(x => x.AddonType == AddonType.Baggage && x.PaxNo == Model.Booking.Passengers[i].Order && x.From == booking.InboundFlight.From);
                                }
                                <span style="text-transform: uppercase;">@((returnBaggage != null && !string.IsNullOrEmpty(returnBaggage.Code) && returnBaggage.Code != "No Bag") ? string.Format("{0}", returnBaggage.Code.Replace("PB", "")) : "0 kg")</span>
                            </td>
                            <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">

                                <span>
                                    @if (seat != null && !pax.PassengerType.Equals("Infant"))
                                    {
                                        <span>@seat.SeatName</span>
                                    }
                                    else
                                    {
                                        <span>Not included</span>
                                    }
                                </span>
                            </td>
                            <td style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">

                                <span>
                                    @if (meal != null)
                                    {
                                        <span>@meal.Name.ToLower(), </span>
                                    }
                                    else
                                    {
                                        <span>Not included</span>
                                    }
                                </span>
                            </td>
                            <td style="width: 10%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                                @if (Model.InsurancePrice > 0)
                                {
                                    <span>Yes</span>
                                }
                                else
                                {
                                    <span>No</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    }

    <!--Insurance-->
    @if (Model.InsurancePrice > 0)
    {
        <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px; border-collapse: collapse;">
            <tbody>
                <tr>
                    <td colspan="2" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Insurance</td>
                </tr>
                <tr>

                    @if (!string.IsNullOrEmpty(Model.Insurance.ProviderCompany))
                    {
                        <td width="50%" style="border: 1px solid #CCC; font-size: 14px; padding: 5px 10px"><strong>Policy Number :</strong> @Model.Insurance.PolicyNumber</td>
                        <td width="50%" style="border: 1px solid #CCC; font-size: 14px; padding: 5px 10px"><strong>Insurance Provider :</strong> @Model.Insurance.ProviderCompany</td> }
                    else
                    {
                        <td colspan="2" style="border: 1px solid #CCC; font-size: 14px; padding: 5px 10px"><strong>Policy Number :</strong> @Model.Insurance.PolicyNumber</td>
                    }

                </tr>
                <tr>
                    <td colspan="2" style="border: 1px solid #CCC; font-size: 14px; padding: 5px 10px"><strong>Amount :</strong> @Model.Currency @Model.InsurancePrice.ToString("N" + Model.CurrencyDecimals, CultureInfo.InvariantCulture)</td>
                </tr>
            </tbody>
        </table>
        <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px; border-collapse: collapse;">
            <tbody>
                <tr>
                    <td colspan="5" style="width: 30%; background: #F0F0F0; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-weight: bold; font-size: 14px">Passenger Name</td>
                    <td colspan="5" style="width: 30%; background: #F0F0F0; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-weight: bold; font-size: 14px">Price</td>
                </tr>

                @for (int i = 0; i < Model.Booking.Passengers.Count; i++)
                {
                    var pax = passengerInfos[i];
                    var priceInsurance = Model.InsurancePrice / Model.Booking.Passengers.Count;
                    <tr>
                        <td colspan="5" style="width: 20%; text-align: left; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                            @(i + 1). @pax.Title @pax.FirstName @pax.LastName (@pax.PassengerType)
                        </td>
                        <td colspan="5" style="width: 20%; text-align: center; color: #333; padding: 0px 10px; border: 1px solid #CCC; font-size: 14px">
                            @Model.Currency @priceInsurance.ToString("F" + Model.CurrencyDecimals, CultureInfo.InvariantCulture)
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }

    <p style="page-break-after: always;"></p>
    <!---hotel info-->
    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0 0 15px 0px; border-bottom: 1px solid #CCC; background-color: ">
        <tbody>
            <tr>
                <td align="center"><a href="#" target="_blank" style="border: none;"><img style="border: none;" src="https://gqcdn.s3.amazonaws.com/GoQuoEngine/G9/logo.png" /></a></td>
            </tr>
        </tbody>
    </table>
    @{
        var noOfRoomsInHotel = 0;
        for (byte i = 0; i < hotel.HotelRooms.Count; i++)
        {
            noOfRoomsInHotel = hotel.HotelRooms.Count;
            var availableRoom = hotel.HotelRooms.ElementAt(i);

            if (availableRoom != null)
            {
                <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px;  border-collapse: collapse;">
                    <tbody>
                        <tr>
                            @if (noOfRoomsInHotel > 1)
                            {
                                <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">
                                    Hotel (@(i + 1))
                                </td>
                            }
                            else
                            {
                                <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Hotel </td>
                            }
                            <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">
                                Hotel Reference Number: @Model.Booking.Hotels[0].ProviderBookingReference
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                <strong>Name :</strong> @hotel.Name
                            </td>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                                <strong>Meal Plan :</strong>
                                @availableRoom.BoardCodeDescription
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Stay : </strong> @totayNights Nights</td>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                                <strong>Transfer :</strong>
                                @if (Model.Booking.ArrivalTransfer != null || Model.Booking.DepartureTransfer != null)
                                {
                                    <span>Included</span>
                                }
                                else
                                {
                                    <span>Not included</span>
                                }
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                <strong>Room Type :</strong>
                                @availableRoom.Description
                            </td>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;"><strong>Taxes :</strong> Included</td>
                        </tr>
                        <tr>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                <strong>Check in:</strong>
                                @((Model.Booking.CheckIn != null && Model.Booking.CheckIn != DateTime.MinValue) ? Model.Booking.CheckIn?.ToString("dd/MM/yyyy") : Model.Booking.DepartureDate.ToString("dd/MM/yyyy"))
                                - <span>2.00 PM</span>
                            </td>
                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                                <strong>Check out:</strong>
                                @((Model.Booking.CheckOut != null && Model.Booking.CheckOut != DateTime.MinValue) ? Model.Booking.CheckOut?.ToString("dd/MM/yyyy") : Model.Booking.ReturnDate.ToString("dd/MM/yyyy"))
                                - <span>12.00 PM</span>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px;">
                                <strong>Hotel Address :</strong> @hotel.Address
                            </td>
                        </tr>
                        @if (!string.IsNullOrEmpty(Model.Booking.Hotels[0].Telephone))
                        {
                            <tr>
                                <td colspan="2" style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                    <strong>Hotel contact number : </strong> @Model.Booking.Hotels[0].Telephone
                                </td>
                            </tr>
                        }
                        <tr>
                            <td colspan="2" style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                <strong>Hotel supplier Name : </strong> @supplierName
                            </td>
                        </tr>
                        @*@if (!string.IsNullOrEmpty(availableRoom.LocalContact))
                            {
                                <tr>
                                    <td colspan="2" style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                        <strong>Supplier emergency contact Number: </strong> @availableRoom.LocalContact
                                    </td>
                                </tr>
                            }*@
                        <tr>
                            <td colspan="2" style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                <strong>@supplierName confirmation numbers: </strong> @hotelConfirmNumber
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4" style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                <p style="margin-bottom: 0; padding-bottom: 0; margin-top: 5px;">
                                    <strong>*Notes:</strong> These are general checkin/checkout times. Please confirm with the hotel upon checking in to avoid inconvenience
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            }
        }
    }

    <!--Tour info-->
    @if (Model.Booking.Tours != null && Model.Booking.Tours.Count > 0)
    {
        int index = 1;

        foreach (var bookingTour in Model.Booking.Tours)
        {
            var tourIndex = Model.Booking.Tours.Count == 1 ? string.Empty : string.Format("({0})", index);


            <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px;  border-collapse: collapse;">
                <tbody>
                    <tr>
                        <td>
                            <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px;  border-collapse: collapse;">
                                <tbody>
                                    <tr>
                                        <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">
                                            Tour @tourIndex
                                        </td>
                                        <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">
                                            Tour Supplier Name: @bookingTour.ProviderName
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Name: </strong>@bookingTour.Name</td>
                                    </tr>
                                    <tr>
                                        <td style="width: 50%;color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"> <strong>SupplierRef: </strong>@bookingTour.ProviderReference</td>
                                        <td style="width: 50%;color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Tour Date: </strong>@bookingTour.OperatorDate.ToString("dd/MM/yyyy")</td>
                                    </tr>
                                    @if (!string.IsNullOrEmpty(bookingTour.DeparturePointName))
                                    {
                                        <tr>
                                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Meeting/pick-up point: </strong>@bookingTour.DeparturePointName </td>
                                            <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Duration: </strong>@bookingTour.Duration</td>
                                        </tr>
                                    }
                                    else if (!string.IsNullOrEmpty(bookingTour.Duration))
                                    {
                                        <tr>
                                            <td colspan="2" style="width: 100%;color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Duration: </strong>@bookingTour.Duration</td>
                                        </tr>
                                    }
                                    @*<tr>
                                            @if (!string.IsNullOrEmpty(bookingTour.DepartureTime))
                                            {
                                                <td style="width: 50%;color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Start or opening time: </strong>@bookingTour.DepartureTime</td>
                                            }
                                            @if (!string.IsNullOrEmpty(bookingTour.EndTime))
                                            {
                                                <td style="width: 50%;color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>End or closing time: </strong>@bookingTour.EndTime</td>
                                            }
                                        </tr>
                                        <tr>
                                            <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                                <strong>Remarks/Notes: </strong><br />
                                                @Raw(bookingTour.Note)
                                            </td>
                                        </tr>*@
                                    @if (!string.IsNullOrEmpty(bookingTour.Comments))
                                    {
                                        <tr>
                                            <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                                                <strong>How to redeem: </strong><br />
                                                @Raw(bookingTour.Comments)
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>
            index++;
        }
    }
    <!--Transfer info-->
    @if (Model.Booking.ArrivalTransfer != null)
    {
	    <p style="page-break-after: always;"></p>
        <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px;  border-collapse: collapse;">
            <tbody>
                <tr>
                    <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Arrival Transfer - Airport to Hotel</td>
                    <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px"><strong>Transfer Booking Id: </strong> @Model.Booking.ArrivalTransfer.ProviderReference</td>
                </tr>
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Name: </strong>@Model.Booking.ArrivalTransfer.VehicleName</td>
                </tr>
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Transfer Supplier Name: </strong>@Model.Booking.ArrivalTransfer.ProviderCode</td>
                </tr>
                <tr>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Pick-up Date: </strong>@Model.Booking.ArrivalTransfer.PickUpDate.ToString("dd/MM/yyyy")</td>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Pick-up Time: </strong>@Model.Booking.ArrivalTransfer.PickUpTime</td>
                </tr>
                <tr>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Pick-up Point: </strong>@Model.Booking.ArrivalTransfer.AirportName</td>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Dropoff Point: </strong>@Model.Booking.ArrivalTransfer.HotelName</td>
                </tr>
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                        <strong>Description: </strong><br />
                        @Raw(Model.Booking.ArrivalTransfer.Description)
                    </td>
                </tr>
                @*<tr>
                        <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Meeting Point: </strong><br />
                            @Raw(arrivalTransferResponse.MeetingPoint)
                        </td>
                    </tr>*@
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                        <strong>Conditions: </strong><br />
                        @if (Model.Booking.ArrivalTransfer.TransferConditions != null && Model.Booking.ArrivalTransfer.TransferConditions.Any())
                        {
                            foreach (var condition in Model.Booking.ArrivalTransfer.TransferConditions)
                            {
                                <span>@Raw(condition)</span> <br />
                            }
                        }
                    </td>
                </tr>
				<!--@if(arrTransferVoucherInfos.Any())
				{
				    foreach (var item in arrTransferVoucherInfos)
					{
					   <tr>
						   <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
							   <p><strong style="text-transform: capitalize;">@item.Name</strong><strong>:</strong><p>
							   <p>@Raw(item.Content)</p>
						   </td>
					   </tr>
					}
				}-->
            </tbody>
        </table>
		 @if(arrTransferVoucherInfos.Any())
		{
			<table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px;  border-collapse: collapse;">
			  <tbody>
				
						@foreach (var item in arrTransferVoucherInfos)
						{
						   <tr>
							   <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
								   <p><strong style="text-transform: capitalize;">@item.Name</strong><strong>:</strong><p>
								   <p>@Raw(item.Content)</p>
							   </td>
						   </tr>
						}
					
			  </tbody>
			</table>
		}
		
    }
    @if (Model.Booking.DepartureTransfer != null)
    {
	    <p style="page-break-after: always;"></p>
        <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px;  border-collapse: collapse;">
            <tbody>
                <tr>
                    <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Departure Transfer - Hotel to Airport</td>
                    <td colspan="1" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px"><strong>Transfer Booking Id: </strong> @Model.Booking.DepartureTransfer.ProviderReference</td>
                </tr>
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Name: </strong>@Model.Booking.DepartureTransfer.VehicleName</td>
                </tr>
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Transfer Supplier Name: </strong>@Model.Booking.DepartureTransfer.ProviderCode</td>
                </tr>
                <tr>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Pick-up Date: </strong>@Model.Booking.DepartureTransfer.PickUpDate.ToString("dd/MM/yyyy")</td>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Pick-up Time: </strong>@Model.Booking.DepartureTransfer.PickUpTime</td>
                </tr>
                <tr>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Pick-up Point: </strong>@Model.Booking.DepartureTransfer.HotelName</td>
                    <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Dropoff Point: </strong>@Model.Booking.DepartureTransfer.AirportName</td>
                </tr>
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                        <strong>Description: </strong><br />
                        @Raw(Model.Booking.DepartureTransfer.Description)
                    </td>
                </tr>
                @*<tr>
                        <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                            <strong>Meeting Point: </strong><br />
                            @Raw(departureTransferResponse.MeetingPoint)
                        </td>
                    </tr>*@
                <tr>
                    <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                        <strong>Conditions: </strong><br />
                        @if (Model.Booking.DepartureTransfer.TransferConditions != null && Model.Booking.DepartureTransfer.TransferConditions.Any())
                        {
                            foreach (var condition in Model.Booking.DepartureTransfer.TransferConditions)
                            {
                                <span>@Raw(condition)</span> <br />
                            }
                        }
                    </td>
                </tr>
				<!--@if(departureTransferVoucherInfos.Any())
				{
				    foreach (var item in departureTransferVoucherInfos)
					{
					   <tr>
						   <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
							   <p><strong style="text-transform: capitalize;">@item.Name</strong><strong>:</strong><p>
							   <p>@Raw(item.Content)</p>
						   </td>
					   </tr>
					}
					
				}-->
            </tbody>
        </table>
		 @if(departureTransferVoucherInfos.Any())
		{
			<table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="line-height: 30px;  border-collapse: collapse;">
			  <tbody>
				
						@foreach (var item in departureTransferVoucherInfos)
						{
						   <tr>
							   <td colspan="2" style="color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
								   <p><strong style="text-transform: capitalize;">@item.Name</strong><strong>:</strong><p>
								   <p>@Raw(item.Content)</p>
							   </td>
						   </tr>
						}
					
			  </tbody>
			</table>
		}
    }
	
	
    <!--Emergency Contact Number-->
    <table bgcolor="#ffffff" width="100%" border="1" cellspacing="0" cellpadding="0" style="margin: 20px 0px; line-height: 30px;  border-collapse: collapse;">
        <tbody>
            <tr>
                <td colspan="2" style="background: #F0F0F0; color: #333; border: 1px solid #CCC; font-size: 16px; font-weight: bold; padding: 5px 10px">Emergency Contact Number </td>
            </tr>
            <tr>
                <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px"><strong>Air Arabia Call Center :</strong> 00971-6-558 0000 </td>
                <td style="width: 50%; color: #333; padding: 5px 10px; border: 1px solid #CCC; font-size: 14px">
                    <strong>Contact Number in Destination : </strong>
                    @if (supplierName != "HMS" && supplierName != "Adonis" && supplierName != "Travco" && supplierName != "Juniper")
                    {
                        <span>+6012 222 6091 / +62-815 815 3857</span>
                    }
                    else
                    {
                        <span>@hotel.Telephone</span>
                    }
                </td>
            </tr>
        </tbody>
    </table>

    <!--ITINERARY -->
    <p style="page-break-after: always;"></p>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0 0 15px 0px; border-bottom: 1px solid #CCC; background-color: ">
        <tbody>
            <tr>
                <td align="center"><a href="#" target="_blank" style="border: none;"><img style="border: none;" src="https://gqcdn.s3.amazonaws.com/GoQuoEngine/G9/logo.png" /></a></td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px; ">
        <tbody>
            <tr>
                <td width="100%" style="color: #333; display: inline-block; padding: 25px 10px 5px; font-size: 20px;">
                    <center>
                        THIS ITINERARY IS YOUR OFFICIAL TRAVEL DOCUMENT
                    </center>
                </td>
            </tr>
            <tr>
                <td width="100%" style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;"> Check In </td>
            </tr>
            <tr>
                <td style="width: 50%; color: #333; padding: 3px 0px; font-size: 14px;">Our check-in will normally open three hours prior to the scheduled departure time flight and close 1 hour prior to the scheduled departure time of the flight. It is the passenger's responsibility to ensure that they have the necessary valid documents, including visas, to meet the immigration requirements of their destination. </td>
            </tr>

        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px;">
        <tbody>
            <tr>
                <td colspan="2" width="100%" style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Infant Policy </td>
            </tr>
            <tr>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;"><strong>Infant Age</strong></td>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;"><strong>Acceptance Condition</strong></td>
            </tr>
            <tr>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;">Below 48hrs (2 days):</td>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;">Infant will not be accepted under any circumstances.</td>
            </tr>
            <tr>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;">From 3rd day to 6th day:</td>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;">Accepted with a Fit to Fly certificate for Infant or Indemnity form signed by the parent.</td>
            </tr>
            <tr>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;">7 days or more:</td>
                <td style="width: 50%; border: 1px solid #CCC; color: #333; padding: 3px 10px; font-size: 14px;">Accepted without any restriction</td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px;">
        <tbody>
            <tr>
                <td width="100%" style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Handling Fee </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">Appointed sales agents of Air Arabia are authorized to collect a handling fee over and above the total fare reflecting on your itinerary print. These charges are regulated by the appointed agents and they are obliged to produce the same information on demand to verify the charges. For handling fee details, please visit <a href="http://www.airarabia.com" target="_blank">www.airarabia.com</a></td>
            </tr>
        </tbody>
    </table>
    <!--khong chuyen chang va pax > 6-->

    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px; ">
        <tbody>
            <tr>
                <td style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Package Changes, Cancellations and Credit </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">1. No modifications are allowed..</td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">
                    2. Packages can be cancelled up to 72 hours prior to departure, subject to a fee of AED 400 (or equivalent) per passenger round trip, plus any Hotel Cancellation fee if applicable.
                </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">
                    3. Cancellation Policy:
                </td>
            </tr>

            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">4. Travel Insurance is not refundable</td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">
                    5. No cancellation is allowed within 72 hours prior to departure.
                </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">
                    6. Air Arabia does not have a refund policy once the booking is paid. In case of cancellation, customer can retain the remaining amount as a credit towards a future flight or package which can be used for travel within one year from the date of payment by the same passenger only. Fees and charges are subject to change.
                </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">
                    7. Air Arabia reserves the right to change your booking at any time. In case of flight changes, cancellation, you will be informed by notification on your mobile number and email address.
                </td>
            </tr>
        </tbody>
    </table>
    <p style="page-break-after: always;"></p>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0 0 15px 0px; border-bottom: 1px solid #CCC; background-color: ">
        <tbody>
            <tr>
                <td align="center"><a href="#" target="_blank" style="border: none;"><img style="border: none;" src="https://gqcdn.s3.amazonaws.com/GoQuoEngine/G9/logo.png" /></a></td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px; ">
        <tbody>
            <tr>
                <td style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Visa </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">The passengers must ensure on their own, that they have a valid passport remains valid for the necessary period according to the travelling destination immigration rules and arranged visas before travelling with this holiday package. </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">Air Arabia does not accept any responsibility if the passenger cannot travel because of any passport or visa issues.By buying this package, the passenger confirms herewith that he/she has agreed on all terms and conditions as issued and amended by the Carrier from time to time on its website. In case of any dispute related to any/all of the services as provided by the Carrier and/or any of its authorized representatives before, during and/or after the provision of the service, such dispute shall be exclusively and solely raised, filed, submitted, registered and/or presented in front of any of the legal courts operating in the Emirate of Sharjah in the United Arab Emirates. </td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px; ">
        <tbody>
            <tr>
                <td style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Ground services in package</td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">Air Arabia is not being itself a provider of any ground services included to this package such as hotel accommodation, transfer service, tour or other trips and activities and do not accept liability for any direct, consequential or incidental damage or any kind occasioned by reason of any act or omission beyond its control including without limitation, any act of negligence, mishap or breach of contract of any third party who is to or does supply any goods or services for this package.</td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">Original rules and conditions of the Hotel that is provided in this package apply. The passenger can check this on the official hotel web site on his own. Air Arabia does not accept liability for any direct, consequential or incidental violation of these rules.</td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px;">
        <tbody>
            <tr>
                <td width="100%" style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Credit card payment </td>
            </tr>

            <tr>
                <td style="width: 50%; color: #333; padding: 3px 0px; font-size: 14px;">Passengers must carry the original credit card or copy of front of the card using which the payment has been made. Airport staff should ask for it as a proof of payment. Failing to provide the card or copy the passenger will not be accepted on Air Arabia flight. </td>
            </tr>
            <tr>
                <td style="width: 50%; color: #333; padding: 3px 0px; font-size: 14px;">2. <strong>Passengers traveling from Colombo, Kiev, Peshawar, Sialkot, Alexandria, Kathmandu, Khartoum & Kenya: </strong> For all bookings made for above mentioned cities, the card holder must be a member of the traveling group and produce Credit Card at check-in for verification. Failing to provide the card, the passenger will not be accepted on Air Arabia </td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px; ">
        <tbody>
            <tr>
                <td style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">Additional Information </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">1. Food and drinks can be purchased on board at affordable prices during the flight. </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">2. Carriage under this ticket by Air Arabia is indicated by use of the 'G9' airline designator code against the relevant travel segment(s) shown above. Where this ticket includes carriage by another carrier, Air Arabia acts solely as agent for that other carrier. </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">3. Air Arabia will be liable only for damage occurring during carriage on flights or flight segments where G9 designator code appears in the carriage box. If Air Arabia issues a Ticket of, or if we Check Baggage for carriage on another carrier, it does so only as agent for the other carrier. Nevertheless, with respect to Checked Baggage, you may make a claim against the first or last carrier. </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">4. For any queries, please call your nearest Call Centre or our Call Centre in Sharjah on +971 6 5580000.(24-hours) or visit our website <a href="http://www.airarabia.com/contact-us" target="_blank">www.airarabia.com/contact-us</a></td>
            </tr>
        </tbody>
    </table>
    <table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0" style="padding: 0px 0px 10px;">
        <tbody>
            <tr>
                <td style="color: #EC0004; display: inline-block; padding: 15px 0px 5px; font-size: 18px;">TuneProtect Travel Insurance By Air Arabia </td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px; font-size: 14px;">“If you have purchased Tune Protect Travel Insurance By Air Arabia, for any claims please visit <a href="http://www.tune2protect.com/airarabia" target="_blank">www.tune2protect.com/airarabia.</a> For all emergency assistance please call on the 24 Hour Emergency Medical Assistance number:</td>
            </tr>
            <tr>
                <td style="color: #333; padding: 3px 0px 20px; font-size: 14px;"> For UAE: +97143619210 / For GCC/Sub Indian Continent: +911244688488 / For Europe/North Africa: +441786310605”</td>
            </tr>
        </tbody>

    </table>
</body>
</html>